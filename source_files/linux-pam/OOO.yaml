pkgname: linux-pam
pkgver: "1.6.1"

source:
  url: https://github.com/linux-pam/linux-pam/releases/download/v1.6.1/Linux-PAM-1.6.1.tar.xz
  md5: 8ad1e72d1ff6480d8e0af658e2d7b768

build:
  - |
    autoreconf -fi
    ./configure --prefix=/usr                        \
            --sbindir=/usr/sbin                  \
            --sysconfdir=/etc                    \
            --libdir=/usr/lib                    \
            --enable-securedir=/usr/lib/security \
            --docdir=/usr/share/doc/Linux-PAM-1.6.1 &&
    make

install:
  - |
    install -v -m755 -d /etc/pam.d &&

    cat > /etc/pam.d/other << "EOF"
    auth     required       pam_deny.so
    account  required       pam_deny.so
    password required       pam_deny.so
    session  required       pam_deny.so
    EOF
    rm -fv /etc/pam.d/other
    make install &&
    chmod -v 4755 /usr/sbin/unix_chkpwd
